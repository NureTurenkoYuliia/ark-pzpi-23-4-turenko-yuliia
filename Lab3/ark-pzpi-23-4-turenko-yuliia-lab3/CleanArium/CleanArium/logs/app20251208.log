2025-12-08 20:47:07.765 +02:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 20:47:07.917 +02:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-08 20:47:07.930 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 20:47:08.198 +02:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-12-08 20:47:08.201 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 20:47:08.206 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-08 20:47:09.018 +02:00 [INF] Executed DbCommand (808ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-08 20:47:09.049 +02:00 [INF] Applying migration '20251208170607_Init'.
2025-12-08 20:47:09.253 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF SCHEMA_ID(N'CleanArium') IS NULL EXEC(N'CREATE SCHEMA [CleanArium];');
2025-12-08 20:47:09.261 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[SystemSettings] (
    [Id] bigint NOT NULL IDENTITY,
    [MaxAquariumsPerUser] int NOT NULL,
    [MaxDevicesPerAquarium] int NOT NULL,
    [MaxAlarmRulesPerDevice] int NOT NULL,
    [MaxScheduledCommandsPerDevice] int NOT NULL,
    CONSTRAINT [PK_SystemSettings] PRIMARY KEY ([Id])
);
2025-12-08 20:47:09.585 +02:00 [ERR] Failed executing DbCommand (323ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[Users] (
    [Id] bigint NOT NULL IDENTITY,
    [UserName] nvarchar(30) NOT NULL,
    [Email] nvarchar(255) NOT NULL,
    [PasswordHash] nvarchar(max) NOT NULL,
    [Salt] nvarchar(max) NOT NULL,
    [Role] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [IsBlocked] bit NOT NULL,
    [LastLoginAt] datetime2 NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-12-08 20:47:10.644 +02:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-12-08 20:47:10.695 +02:00 [INF] Refresh token cleanup service started.
2025-12-08 20:47:11.663 +02:00 [INF] Now listening on: https://localhost:7085
2025-12-08 20:47:11.663 +02:00 [INF] Now listening on: http://localhost:5250
2025-12-08 20:47:11.749 +02:00 [INF] Executed DbCommand (222ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[ExpiresAt], [r].[IsRevoked], [r].[Token], [r].[UserId]
FROM [CleanArium].[RefreshTokens] AS [r]
WHERE [r].[ExpiresAt] < GETUTCDATE()
2025-12-08 20:47:11.981 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-08 20:47:11.982 +02:00 [INF] Hosting environment: Development
2025-12-08 20:47:11.982 +02:00 [INF] Content root path: C:\Users\User\source\repos\CleanArium\CleanArium
2025-12-08 20:47:14.591 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/index.html - null null
2025-12-08 20:47:15.526 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/index.html - 200 null text/html;charset=utf-8 955.8698ms
2025-12-08 20:47:16.706 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_vs/browserLink - null null
2025-12-08 20:47:16.707 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - null null
2025-12-08 20:47:16.762 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - 200 13756 application/javascript; charset=utf-8 54.9597ms
2025-12-08 20:47:17.804 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_vs/browserLink - 200 null text/javascript; charset=UTF-8 1098.9766ms
2025-12-08 20:47:18.283 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - null null
2025-12-08 20:47:18.341 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 58.6522ms
2025-12-08 20:57:18.517 +02:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 20:57:18.709 +02:00 [INF] Executed DbCommand (74ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-08 20:57:18.731 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 20:57:18.740 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-08 20:57:18.804 +02:00 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-08 20:57:18.838 +02:00 [INF] Applying migration '20251208185619_AddSystemSettings'.
2025-12-08 20:57:19.053 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF SCHEMA_ID(N'CleanArium') IS NULL EXEC(N'CREATE SCHEMA [CleanArium];');
2025-12-08 20:57:19.108 +02:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[SystemSettings] (
    [Id] bigint NOT NULL IDENTITY,
    [MaxAquariumsPerUser] int NOT NULL,
    [MaxDevicesPerAquarium] int NOT NULL,
    [MaxAlarmRulesPerDevice] int NOT NULL,
    [MaxScheduledCommandsPerDevice] int NOT NULL,
    CONSTRAINT [PK_SystemSettings] PRIMARY KEY ([Id])
);
2025-12-08 20:57:19.151 +02:00 [ERR] Failed executing DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[Users] (
    [Id] bigint NOT NULL IDENTITY,
    [UserName] nvarchar(30) NOT NULL,
    [Email] nvarchar(255) NOT NULL,
    [PasswordHash] nvarchar(max) NOT NULL,
    [Salt] nvarchar(max) NOT NULL,
    [Role] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [IsBlocked] bit NOT NULL,
    [LastLoginAt] datetime2 NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-12-08 20:57:20.020 +02:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-12-08 20:57:20.056 +02:00 [INF] Refresh token cleanup service started.
2025-12-08 20:57:20.614 +02:00 [INF] Now listening on: https://localhost:7085
2025-12-08 20:57:20.614 +02:00 [INF] Now listening on: http://localhost:5250
2025-12-08 20:57:21.348 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-08 20:57:21.349 +02:00 [INF] Hosting environment: Development
2025-12-08 20:57:21.349 +02:00 [INF] Content root path: C:\Users\User\source\repos\CleanArium\CleanArium
2025-12-08 20:57:24.316 +02:00 [INF] Executed DbCommand (2,960ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[ExpiresAt], [r].[IsRevoked], [r].[Token], [r].[UserId]
FROM [CleanArium].[RefreshTokens] AS [r]
WHERE [r].[ExpiresAt] < GETUTCDATE()
2025-12-08 20:57:24.463 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/index.html - null null
2025-12-08 20:57:25.359 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/index.html - 200 null text/html;charset=utf-8 926.6747ms
2025-12-08 20:57:25.589 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - null null
2025-12-08 20:57:25.630 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_vs/browserLink - null null
2025-12-08 20:57:25.636 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - 200 13756 application/javascript; charset=utf-8 46.6471ms
2025-12-08 20:57:25.767 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_vs/browserLink - 200 null text/javascript; charset=UTF-8 137.3477ms
2025-12-08 20:57:25.984 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - null null
2025-12-08 20:57:26.124 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 139.672ms
2025-12-08 21:10:34.517 +02:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-12-08 21:10:34.689 +02:00 [INF] Refresh token cleanup service started.
2025-12-08 21:10:35.287 +02:00 [INF] Now listening on: https://localhost:7085
2025-12-08 21:10:35.288 +02:00 [INF] Now listening on: http://localhost:5250
2025-12-08 21:10:35.502 +02:00 [ERR] An error occurred using the connection to database '' on server ''.
2025-12-08 21:10:35.588 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Persistence.Application.CleanAriumDbContext'.
System.InvalidOperationException: The ConnectionString property has not been initialized.
   at Microsoft.Data.SqlClient.SqlConnection.PermissionDemand()
   at Microsoft.Data.SqlClient.SqlConnectionFactory.PermissionDemand(DbConnection outerConnection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: The ConnectionString property has not been initialized.
   at Microsoft.Data.SqlClient.SqlConnection.PermissionDemand()
   at Microsoft.Data.SqlClient.SqlConnectionFactory.PermissionDemand(DbConnection outerConnection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-12-08 21:10:35.715 +02:00 [ERR] Error while cleaning up refresh tokens.
System.InvalidOperationException: The ConnectionString property has not been initialized.
   at Microsoft.Data.SqlClient.SqlConnection.PermissionDemand()
   at Microsoft.Data.SqlClient.SqlConnectionFactory.PermissionDemand(DbConnection outerConnection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Persistence.Repositories.RefreshTokenRepository.DeleteExpiredAsync() in C:\Users\User\source\repos\CleanArium\Persistence\Repositories\RefreshTokenRepository.cs:line 42
   at Persistence.Services.Token.RefreshTokenCleanupService.ExecuteAsync(CancellationToken stoppingToken) in C:\Users\User\source\repos\CleanArium\Persistence\Services\RefreshTokenCleanupService.cs:line 30
2025-12-08 21:10:36.353 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-08 21:10:36.387 +02:00 [INF] Hosting environment: Development
2025-12-08 21:10:36.387 +02:00 [INF] Content root path: C:\Users\User\source\repos\CleanArium\CleanArium
2025-12-08 21:10:37.355 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/index.html - null null
2025-12-08 21:10:38.588 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/index.html - 200 null text/html;charset=utf-8 1253.3422ms
2025-12-08 21:10:38.755 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - null null
2025-12-08 21:10:38.921 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_vs/browserLink - null null
2025-12-08 21:10:38.927 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - 200 13756 application/javascript; charset=utf-8 172.3294ms
2025-12-08 21:10:39.831 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_vs/browserLink - 200 null text/javascript; charset=UTF-8 909.3682ms
2025-12-08 21:10:40.134 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - null null
2025-12-08 21:10:40.269 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 135.0431ms
2025-12-08 21:13:20.703 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Auth/register - application/json 81
2025-12-08 21:13:20.731 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 21:13:20.806 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(CleanArium.Contracts.Auth.RegisterRequest) on controller CleanArium.Controllers.AuthController (CleanArium).
2025-12-08 21:13:20.819 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-12-08 21:13:21.249 +02:00 [ERR] An error occurred using the connection to database '' on server ''.
2025-12-08 21:13:21.255 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Persistence.Application.CleanAriumDbContext'.
System.InvalidOperationException: The ConnectionString property has not been initialized.
   at Microsoft.Data.SqlClient.SqlConnection.PermissionDemand()
   at Microsoft.Data.SqlClient.SqlConnectionFactory.PermissionDemand(DbConnection outerConnection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: The ConnectionString property has not been initialized.
   at Microsoft.Data.SqlClient.SqlConnection.PermissionDemand()
   at Microsoft.Data.SqlClient.SqlConnectionFactory.PermissionDemand(DbConnection outerConnection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-12-08 21:13:21.596 +02:00 [INF] Executed action CleanArium.Controllers.AuthController.Register (CleanArium) in 783.4209ms
2025-12-08 21:13:21.598 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 21:13:21.644 +02:00 [ERR] Unhandled exception
System.InvalidOperationException: The ConnectionString property has not been initialized.
   at Microsoft.Data.SqlClient.SqlConnection.PermissionDemand()
   at Microsoft.Data.SqlClient.SqlConnectionFactory.PermissionDemand(DbConnection outerConnection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.InternalOpenAsync(CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternalAsync(Boolean errorsExpected, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenAsync(CancellationToken cancellationToken, Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Application.Auth.Commands.Register.RegisterCommandValidator.AlreadyExists(RegisterCommand cmd, CancellationToken ct) in C:\Users\User\source\repos\CleanArium\Application\Auth\Commands\Register\RegisterCommandValidator.cs:line 28
   at FluentValidation.Internal.RuleComponent`2.ValidateAsync(ValidationContext`1 context, TProperty value, CancellationToken cancellation) in /_/src/FluentValidation/Internal/RuleComponent.cs:line 70
   at FluentValidation.Internal.PropertyRule`2.ValidateAsync(ValidationContext`1 context, CancellationToken cancellation) in /_/src/FluentValidation/Internal/PropertyRule.cs:line 122
   at FluentValidation.AbstractValidator`1.ValidateInternalAsync(ValidationContext`1 context, CancellationToken cancellation) in /_/src/FluentValidation/AbstractValidator.cs:line 164
   at FluentValidation.AbstractValidator`1.ValidateAsync(ValidationContext`1 context, CancellationToken cancellation) in /_/src/FluentValidation/AbstractValidator.cs:line 137
   at CleanArium.Extensions.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\User\source\repos\CleanArium\CleanArium\Extensions\ValidationBehavior.cs:line 25
   at CleanArium.Controllers.AuthController.Register(RegisterRequest request) in C:\Users\User\source\repos\CleanArium\CleanArium\Controllers\AuthController.cs:line 33
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at CleanArium.Middleware.ExceptionMiddleware.Invoke(HttpContext context) in C:\Users\User\source\repos\CleanArium\CleanArium\Middleware\ExceptionMiddleware.cs:line 18
2025-12-08 21:13:21.728 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Auth/register - 500 null application/json; charset=utf-8 1024.8323ms
2025-12-08 21:14:28.412 +02:00 [INF] Executed DbCommand (558ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [CleanAriumDb];
2025-12-08 21:14:28.791 +02:00 [INF] Executed DbCommand (297ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [CleanAriumDb] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-12-08 21:14:28.832 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 21:14:29.032 +02:00 [INF] Executed DbCommand (60ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-12-08 21:14:29.034 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 21:14:29.062 +02:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-08 21:14:29.103 +02:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-08 21:14:29.123 +02:00 [INF] Applying migration '20251208185619_AddSystemSettings'.
2025-12-08 21:14:29.338 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF SCHEMA_ID(N'CleanArium') IS NULL EXEC(N'CREATE SCHEMA [CleanArium];');
2025-12-08 21:14:29.355 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[SystemSettings] (
    [Id] bigint NOT NULL IDENTITY,
    [MaxAquariumsPerUser] int NOT NULL,
    [MaxDevicesPerAquarium] int NOT NULL,
    [MaxAlarmRulesPerDevice] int NOT NULL,
    [MaxScheduledCommandsPerDevice] int NOT NULL,
    CONSTRAINT [PK_SystemSettings] PRIMARY KEY ([Id])
);
2025-12-08 21:14:29.368 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[Users] (
    [Id] bigint NOT NULL IDENTITY,
    [UserName] nvarchar(30) NOT NULL,
    [Email] nvarchar(255) NOT NULL,
    [PasswordHash] nvarchar(max) NOT NULL,
    [Salt] nvarchar(max) NOT NULL,
    [Role] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [IsBlocked] bit NOT NULL,
    [LastLoginAt] datetime2 NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-12-08 21:14:29.376 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[Aquariums] (
    [Id] bigint NOT NULL IDENTITY,
    [UserId] bigint NOT NULL,
    [Name] nvarchar(30) NOT NULL,
    [Location] nvarchar(80) NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Aquariums] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Aquariums_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [CleanArium].[Users] ([Id]) ON DELETE CASCADE
);
2025-12-08 21:14:29.382 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[PasswordResetTokens] (
    [Id] bigint NOT NULL IDENTITY,
    [UserId] bigint NOT NULL,
    [Token] nvarchar(max) NOT NULL,
    [ExpiresAt] datetime2 NOT NULL,
    [IsUsed] bit NOT NULL,
    CONSTRAINT [PK_PasswordResetTokens] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_PasswordResetTokens_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [CleanArium].[Users] ([Id]) ON DELETE CASCADE
);
2025-12-08 21:14:29.387 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[RefreshTokens] (
    [Id] bigint NOT NULL IDENTITY,
    [UserId] bigint NOT NULL,
    [Token] nvarchar(max) NOT NULL,
    [ExpiresAt] datetime2 NOT NULL,
    [IsRevoked] bit NOT NULL,
    CONSTRAINT [PK_RefreshTokens] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_RefreshTokens_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [CleanArium].[Users] ([Id]) ON DELETE CASCADE
);
2025-12-08 21:14:29.390 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[SupportMessages] (
    [Id] bigint NOT NULL IDENTITY,
    [UserId] bigint NOT NULL,
    [IsFirst] bit NOT NULL,
    [ReplyToMessageId] bigint NULL,
    [Sender] int NOT NULL,
    [Subject] nvarchar(80) NOT NULL,
    [Message] nvarchar(400) NOT NULL,
    [MessageStatus] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_SupportMessages] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_SupportMessages_SupportMessages_ReplyToMessageId] FOREIGN KEY ([ReplyToMessageId]) REFERENCES [CleanArium].[SupportMessages] ([Id]),
    CONSTRAINT [FK_SupportMessages_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [CleanArium].[Users] ([Id]) ON DELETE CASCADE
);
2025-12-08 21:14:29.393 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[Devices] (
    [Id] bigint NOT NULL IDENTITY,
    [AquariumId] bigint NOT NULL,
    [DeviceType] int NOT NULL,
    [DeviceStatus] int NOT NULL,
    CONSTRAINT [PK_Devices] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Devices_Aquariums_AquariumId] FOREIGN KEY ([AquariumId]) REFERENCES [CleanArium].[Aquariums] ([Id]) ON DELETE CASCADE
);
2025-12-08 21:14:29.397 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[AlarmRules] (
    [Id] bigint NOT NULL IDENTITY,
    [DeviceId] bigint NOT NULL,
    [Condition] int NOT NULL,
    [Threshold] real NOT NULL,
    [Unit] nvarchar(max) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_AlarmRules] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AlarmRules_Devices_DeviceId] FOREIGN KEY ([DeviceId]) REFERENCES [CleanArium].[Devices] ([Id]) ON DELETE CASCADE
);
2025-12-08 21:14:29.401 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[ExecutedCommands] (
    [Id] bigint NOT NULL IDENTITY,
    [DeviceId] bigint NOT NULL,
    [CommandType] int NOT NULL,
    [CommandStatus] int NOT NULL,
    [IssuedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_ExecutedCommands] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ExecutedCommands_Devices_DeviceId] FOREIGN KEY ([DeviceId]) REFERENCES [CleanArium].[Devices] ([Id]) ON DELETE CASCADE
);
2025-12-08 21:14:29.406 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[ScheduledCommands] (
    [Id] bigint NOT NULL IDENTITY,
    [DeviceId] bigint NOT NULL,
    [CommandType] int NOT NULL,
    [StartTime] datetime2 NOT NULL,
    [RepeatMode] int NOT NULL,
    [IntervalMinutes] int NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_ScheduledCommands] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ScheduledCommands_Devices_DeviceId] FOREIGN KEY ([DeviceId]) REFERENCES [CleanArium].[Devices] ([Id]) ON DELETE CASCADE
);
2025-12-08 21:14:29.409 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[SensorData] (
    [Id] bigint NOT NULL IDENTITY,
    [DeviceId] bigint NOT NULL,
    [Value] real NOT NULL,
    [Unit] nvarchar(max) NOT NULL,
    [DateTime] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_SensorData] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_SensorData_Devices_DeviceId] FOREIGN KEY ([DeviceId]) REFERENCES [CleanArium].[Devices] ([Id]) ON DELETE CASCADE
);
2025-12-08 21:14:29.413 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[Notifications] (
    [Id] bigint NOT NULL IDENTITY,
    [UserId] bigint NOT NULL,
    [Title] nvarchar(80) NOT NULL,
    [Content] nvarchar(400) NOT NULL,
    [IsRead] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [AlarmRuleId] bigint NULL,
    [ScheduledCommandId] bigint NULL,
    CONSTRAINT [PK_Notifications] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Notifications_AlarmRules_AlarmRuleId] FOREIGN KEY ([AlarmRuleId]) REFERENCES [CleanArium].[AlarmRules] ([Id]),
    CONSTRAINT [FK_Notifications_ScheduledCommands_ScheduledCommandId] FOREIGN KEY ([ScheduledCommandId]) REFERENCES [CleanArium].[ScheduledCommands] ([Id]),
    CONSTRAINT [FK_Notifications_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [CleanArium].[Users] ([Id]) ON DELETE CASCADE
);
2025-12-08 21:14:29.420 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AlarmRules_DeviceId] ON [CleanArium].[AlarmRules] ([DeviceId]);
2025-12-08 21:14:29.423 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Aquariums_UserId] ON [CleanArium].[Aquariums] ([UserId]);
2025-12-08 21:14:29.425 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Devices_AquariumId] ON [CleanArium].[Devices] ([AquariumId]);
2025-12-08 21:14:29.427 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ExecutedCommands_DeviceId] ON [CleanArium].[ExecutedCommands] ([DeviceId]);
2025-12-08 21:14:29.430 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_AlarmRuleId] ON [CleanArium].[Notifications] ([AlarmRuleId]);
2025-12-08 21:14:29.431 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_ScheduledCommandId] ON [CleanArium].[Notifications] ([ScheduledCommandId]);
2025-12-08 21:14:29.434 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_UserId] ON [CleanArium].[Notifications] ([UserId]);
2025-12-08 21:14:29.435 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetTokens_UserId] ON [CleanArium].[PasswordResetTokens] ([UserId]);
2025-12-08 21:14:29.436 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_RefreshTokens_UserId] ON [CleanArium].[RefreshTokens] ([UserId]);
2025-12-08 21:14:29.437 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ScheduledCommands_DeviceId] ON [CleanArium].[ScheduledCommands] ([DeviceId]);
2025-12-08 21:14:29.438 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_SensorData_DeviceId] ON [CleanArium].[SensorData] ([DeviceId]);
2025-12-08 21:14:29.439 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_SupportMessages_ReplyToMessageId] ON [CleanArium].[SupportMessages] ([ReplyToMessageId]);
2025-12-08 21:14:29.442 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_SupportMessages_UserId] ON [CleanArium].[SupportMessages] ([UserId]);
2025-12-08 21:14:29.465 +02:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251208185619_AddSystemSettings', N'8.0.18');
2025-12-08 21:14:29.481 +02:00 [INF] Checking if admin user exists...
2025-12-08 21:14:30.012 +02:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Role] = 3
2025-12-08 21:14:30.032 +02:00 [INF] Admin does not exist. Creating default admin...
2025-12-08 21:14:30.445 +02:00 [INF] Executed DbCommand (80ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 255), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Users] ([CreatedAt], [Email], [IsBlocked], [LastLoginAt], [PasswordHash], [Role], [Salt], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-12-08 21:14:30.496 +02:00 [INF] Admin user created successfully.
2025-12-08 21:14:30.855 +02:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-12-08 21:14:30.876 +02:00 [INF] Refresh token cleanup service started.
2025-12-08 21:14:30.932 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[ExpiresAt], [r].[IsRevoked], [r].[Token], [r].[UserId]
FROM [CleanArium].[RefreshTokens] AS [r]
WHERE [r].[ExpiresAt] < GETUTCDATE()
2025-12-08 21:14:31.386 +02:00 [INF] Now listening on: https://localhost:7085
2025-12-08 21:14:31.386 +02:00 [INF] Now listening on: http://localhost:5250
2025-12-08 21:14:32.104 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-08 21:14:32.105 +02:00 [INF] Hosting environment: Development
2025-12-08 21:14:32.105 +02:00 [INF] Content root path: C:\Users\User\source\repos\CleanArium\CleanArium
2025-12-08 21:14:33.668 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/index.html - null null
2025-12-08 21:14:34.526 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/index.html - 200 null text/html;charset=utf-8 878.4215ms
2025-12-08 21:14:34.596 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_vs/browserLink - null null
2025-12-08 21:14:34.596 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - null null
2025-12-08 21:14:34.612 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - 200 13756 application/javascript; charset=utf-8 15.4039ms
2025-12-08 21:14:34.762 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_vs/browserLink - 200 null text/javascript; charset=UTF-8 166.0288ms
2025-12-08 21:14:34.943 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - null null
2025-12-08 21:14:35.111 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 168.4335ms
2025-12-08 21:16:32.352 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Auth/register - application/json 77
2025-12-08 21:16:32.492 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 21:16:32.659 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(CleanArium.Contracts.Auth.RegisterRequest) on controller CleanArium.Controllers.AuthController (CleanArium).
2025-12-08 21:16:32.682 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-12-08 21:16:33.306 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 21:16:33.691 +02:00 [INF] Executed action CleanArium.Controllers.AuthController.Register (CleanArium) in 1025.9105ms
2025-12-08 21:16:33.693 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 21:16:33.981 +02:00 [ERR] Unhandled exception
FluentValidation.ValidationException: Validation failed: 
 -- Password: Довжина 'Password' має бути не меншою ніж 8 символів. Ви ввели 6 символів. Severity: Error
   at CleanArium.Extensions.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\User\source\repos\CleanArium\CleanArium\Extensions\ValidationBehavior.cs:line 34
   at CleanArium.Controllers.AuthController.Register(RegisterRequest request) in C:\Users\User\source\repos\CleanArium\CleanArium\Controllers\AuthController.cs:line 33
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at CleanArium.Middleware.ExceptionMiddleware.Invoke(HttpContext context) in C:\Users\User\source\repos\CleanArium\CleanArium\Middleware\ExceptionMiddleware.cs:line 18
2025-12-08 21:16:34.148 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Auth/register - 500 null application/json; charset=utf-8 1816.5433ms
2025-12-08 21:16:53.194 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Auth/register - application/json 79
2025-12-08 21:16:53.208 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 21:16:53.209 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(CleanArium.Contracts.Auth.RegisterRequest) on controller CleanArium.Controllers.AuthController (CleanArium).
2025-12-08 21:16:53.259 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 21:16:53.297 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 21:16:53.411 +02:00 [INF] Executed DbCommand (43ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Boolean), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Users] ([Email], [IsBlocked], [LastLoginAt], [PasswordHash], [Role], [Salt], [UserName])
OUTPUT INSERTED.[Id], INSERTED.[CreatedAt]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-12-08 21:16:53.897 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[RefreshTokens] ([ExpiresAt], [IsRevoked], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 21:16:53.900 +02:00 [INF] Successful registration for user: 2 
2025-12-08 21:16:53.910 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Auth.AuthResponseDto'.
2025-12-08 21:16:53.914 +02:00 [INF] Executed action CleanArium.Controllers.AuthController.Register (CleanArium) in 705.0382ms
2025-12-08 21:16:53.914 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 21:16:53.915 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Auth/register - 200 null application/json; charset=utf-8 720.8682ms
2025-12-08 21:17:28.239 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Aquarium/import - multipart/form-data; boundary=----WebKitFormBoundarydTl6klcf1IXX9S29 349
2025-12-08 21:17:28.391 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AquariumController.ImportAquariums (CleanArium)'
2025-12-08 21:17:28.399 +02:00 [INF] Route matched with {action = "ImportAquariums", controller = "Aquarium"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ImportAquariums(Microsoft.AspNetCore.Http.IFormFile) on controller CleanArium.Controllers.AquariumController (CleanArium).
2025-12-08 21:17:28.521 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 21:17:28.594 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Boolean), @p1='?' (Size = 80), @p2='?' (Size = 30), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Aquariums] ([IsActive], [Location], [Name], [UserId])
OUTPUT INSERTED.[Id], INSERTED.[CreatedAt]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 21:17:28.652 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Devices] ([AquariumId], [DeviceStatus], [DeviceType])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-12-08 21:17:28.659 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Devices] ([AquariumId], [DeviceStatus], [DeviceType])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-12-08 21:17:28.661 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Devices] ([AquariumId], [DeviceStatus], [DeviceType])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-12-08 21:17:28.670 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Boolean), @p1='?' (Size = 80), @p2='?' (Size = 30), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Aquariums] ([IsActive], [Location], [Name], [UserId])
OUTPUT INSERTED.[Id], INSERTED.[CreatedAt]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 21:17:28.673 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Devices] ([AquariumId], [DeviceStatus], [DeviceType])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-12-08 21:17:28.676 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Devices] ([AquariumId], [DeviceStatus], [DeviceType])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-12-08 21:17:28.678 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Boolean), @p1='?' (Size = 80), @p2='?' (Size = 30), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Aquariums] ([IsActive], [Location], [Name], [UserId])
OUTPUT INSERTED.[Id], INSERTED.[CreatedAt]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 21:17:28.680 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Devices] ([AquariumId], [DeviceStatus], [DeviceType])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-12-08 21:17:28.682 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Result.ImportResult'.
2025-12-08 21:17:28.686 +02:00 [INF] Executed action CleanArium.Controllers.AquariumController.ImportAquariums (CleanArium) in 286.8496ms
2025-12-08 21:17:28.686 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AquariumController.ImportAquariums (CleanArium)'
2025-12-08 21:17:28.689 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Aquarium/import - 200 null application/json; charset=utf-8 449.6341ms
2025-12-08 21:17:57.120 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Admin/logs - null null
2025-12-08 21:17:57.158 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin|Moderator)
2025-12-08 21:17:57.161 +02:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-12-08 21:17:57.162 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Admin/logs - 403 0 null 42.0956ms
2025-12-08 21:19:26.029 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/AlarmRule/1/import - multipart/form-data; boundary=----WebKitFormBoundaryqR577jeTMJazQPj0 241
2025-12-08 21:19:26.043 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AlarmRuleController.ImportRules (CleanArium)'
2025-12-08 21:19:26.076 +02:00 [INF] Route matched with {action = "ImportRules", controller = "AlarmRule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ImportRules(Int64, Microsoft.AspNetCore.Http.IFormFile) on controller CleanArium.Controllers.AlarmRuleController (CleanArium).
2025-12-08 21:19:26.186 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[AquariumId], [d].[DeviceStatus], [d].[DeviceType]
FROM [CleanArium].[Devices] AS [d]
WHERE [d].[Id] = @__id_0
2025-12-08 21:19:26.383 +02:00 [INF] Executed DbCommand (56ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int64), @p2='?' (DbType = Boolean), @p3='?' (DbType = Single), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[AlarmRules] ([Condition], [DeviceId], [IsActive], [Threshold], [Unit])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-12-08 21:19:26.391 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Result.ImportResult'.
2025-12-08 21:19:26.391 +02:00 [INF] Executed action CleanArium.Controllers.AlarmRuleController.ImportRules (CleanArium) in 314.6053ms
2025-12-08 21:19:26.391 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AlarmRuleController.ImportRules (CleanArium)'
2025-12-08 21:19:26.391 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/AlarmRule/1/import - 200 null application/json; charset=utf-8 363.2201ms
2025-12-08 21:19:38.254 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/AlarmRule/1/deactivate - null 0
2025-12-08 21:19:38.260 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin|Moderator)
2025-12-08 21:19:38.260 +02:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-12-08 21:19:38.261 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/AlarmRule/1/deactivate - 403 0 null 6.0691ms
2025-12-08 21:19:48.542 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Aquarium/get-all-by-user - null null
2025-12-08 21:19:48.555 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AquariumController.GetAllByUser (CleanArium)'
2025-12-08 21:19:48.560 +02:00 [INF] Route matched with {action = "GetAllByUser", controller = "Aquarium"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllByUser(System.Threading.CancellationToken) on controller CleanArium.Controllers.AquariumController (CleanArium).
2025-12-08 21:19:48.577 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 21:19:48.593 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[CreatedAt], [a].[IsActive], [a].[Location], [a].[Name], [a].[UserId]
FROM [CleanArium].[Aquariums] AS [a]
WHERE [a].[UserId] = @__userId_0
2025-12-08 21:19:48.596 +02:00 [INF] Successfully retrieved aquariums for user: 2 
2025-12-08 21:19:48.596 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.Aquariums.AquariumDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 21:19:48.611 +02:00 [INF] Executed action CleanArium.Controllers.AquariumController.GetAllByUser (CleanArium) in 50.3009ms
2025-12-08 21:19:48.611 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AquariumController.GetAllByUser (CleanArium)'
2025-12-08 21:19:48.613 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Aquarium/get-all-by-user - 200 null application/json; charset=utf-8 69.4704ms
2025-12-08 21:20:44.192 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/SupportMessage/create - application/json 94
2025-12-08 21:20:44.210 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.SupportMessageController.Create (CleanArium)'
2025-12-08 21:20:44.215 +02:00 [INF] Route matched with {action = "Create", controller = "SupportMessage"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(CleanArium.Contracts.SupportMessages.CreateMessageRequest, System.Threading.CancellationToken) on controller CleanArium.Controllers.SupportMessageController (CleanArium).
2025-12-08 21:20:44.253 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 21:20:44.339 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 400), @p3='?' (DbType = Int32), @p4='?' (DbType = Int64), @p5='?' (DbType = Int32), @p6='?' (Size = 80), @p7='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[SupportMessages] ([CreatedAt], [IsFirst], [Message], [MessageStatus], [ReplyToMessageId], [Sender], [Subject], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-12-08 21:20:44.346 +02:00 [INF] SupportMessage created: 1
2025-12-08 21:20:44.347 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Int64'.
2025-12-08 21:20:44.354 +02:00 [INF] Executed action CleanArium.Controllers.SupportMessageController.Create (CleanArium) in 138.9545ms
2025-12-08 21:20:44.354 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.SupportMessageController.Create (CleanArium)'
2025-12-08 21:20:44.354 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/SupportMessage/create - 200 null application/json; charset=utf-8 162.0559ms
2025-12-08 21:21:30.275 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/SupportMessage/get-all-for-admin - null null
2025-12-08 21:21:30.279 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-12-08 21:21:30.279 +02:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-12-08 21:21:30.279 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/SupportMessage/get-all-for-admin - 403 0 null 3.9955ms
2025-12-08 21:21:36.603 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/SupportMessage/get-all-by-user - null null
2025-12-08 21:21:36.604 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.SupportMessageController.GetAllByUserId (CleanArium)'
2025-12-08 21:21:36.612 +02:00 [INF] Route matched with {action = "GetAllByUserId", controller = "SupportMessage"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllByUserId(System.Threading.CancellationToken) on controller CleanArium.Controllers.SupportMessageController (CleanArium).
2025-12-08 21:21:36.659 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[CreatedAt], [s].[IsFirst], [s].[Message], [s].[MessageStatus], [s].[ReplyToMessageId], [s].[Sender], [s].[Subject], [s].[UserId]
FROM [CleanArium].[SupportMessages] AS [s]
WHERE [s].[UserId] = @__userId_0 AND [s].[IsFirst] = CAST(1 AS bit)
2025-12-08 21:21:36.662 +02:00 [INF] Successfully retrieved messages for User: 2 
2025-12-08 21:21:36.662 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.SupportMessages.PreviewSupportMessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 21:21:36.675 +02:00 [INF] Executed action CleanArium.Controllers.SupportMessageController.GetAllByUserId (CleanArium) in 63.3884ms
2025-12-08 21:21:36.675 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.SupportMessageController.GetAllByUserId (CleanArium)'
2025-12-08 21:21:36.676 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/SupportMessage/get-all-by-user - 200 null application/json; charset=utf-8 72.8858ms
2025-12-08 21:23:54.840 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Device/get-devices-by-aquarium/1 - null null
2025-12-08 21:23:54.842 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.DeviceController.GetAllByAquarium (CleanArium)'
2025-12-08 21:23:54.859 +02:00 [INF] Route matched with {action = "GetAllByAquarium", controller = "Device"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllByAquarium(Int64, System.Threading.CancellationToken) on controller CleanArium.Controllers.DeviceController (CleanArium).
2025-12-08 21:23:54.914 +02:00 [INF] Executed DbCommand (32ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 21:23:54.947 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[@__userId_0='?' (DbType = Int64), @__aquariumId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[Aquariums] AS [a]
        WHERE [a].[UserId] = @__userId_0 AND [a].[Id] = @__aquariumId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 21:23:54.975 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__aquariumId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[Id], [d].[AquariumId], [d].[DeviceStatus], [d].[DeviceType]
FROM [CleanArium].[Devices] AS [d]
WHERE [d].[AquariumId] = @__aquariumId_0
2025-12-08 21:23:54.979 +02:00 [INF] Successfully retrieved devices for aquarium: 1 
2025-12-08 21:23:54.980 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.Devices.DeviceDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 21:23:54.998 +02:00 [INF] Executed action CleanArium.Controllers.DeviceController.GetAllByAquarium (CleanArium) in 139.0798ms
2025-12-08 21:23:54.998 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.DeviceController.GetAllByAquarium (CleanArium)'
2025-12-08 21:23:54.998 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Device/get-devices-by-aquarium/1 - 200 null application/json; charset=utf-8 157.9372ms
2025-12-08 21:28:01.224 +02:00 [INF] Executed DbCommand (89ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 21:28:01.418 +02:00 [INF] Executed DbCommand (90ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-08 21:28:01.430 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 21:28:01.431 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-08 21:28:01.531 +02:00 [INF] Executed DbCommand (72ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-08 21:28:01.563 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-12-08 21:28:01.572 +02:00 [INF] Checking if admin user exists...
2025-12-08 21:28:02.400 +02:00 [INF] Executed DbCommand (128ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Role] = 3
2025-12-08 21:28:02.583 +02:00 [INF] Admin already exists. Skipping seeding.
2025-12-08 21:28:02.929 +02:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-12-08 21:28:02.956 +02:00 [INF] Refresh token cleanup service started.
2025-12-08 21:28:03.088 +02:00 [INF] Executed DbCommand (72ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[ExpiresAt], [r].[IsRevoked], [r].[Token], [r].[UserId]
FROM [CleanArium].[RefreshTokens] AS [r]
WHERE [r].[ExpiresAt] < GETUTCDATE()
2025-12-08 21:28:03.537 +02:00 [INF] Now listening on: https://localhost:7085
2025-12-08 21:28:03.537 +02:00 [INF] Now listening on: http://localhost:5250
2025-12-08 21:28:03.792 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-08 21:28:03.793 +02:00 [INF] Hosting environment: Development
2025-12-08 21:28:03.793 +02:00 [INF] Content root path: C:\Users\User\source\repos\CleanArium\CleanArium
2025-12-08 21:28:05.959 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/index.html - null null
2025-12-08 21:28:06.984 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/index.html - 200 null text/html;charset=utf-8 1045.632ms
2025-12-08 21:28:07.064 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_vs/browserLink - null null
2025-12-08 21:28:07.064 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - null null
2025-12-08 21:28:07.077 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - 200 13756 application/javascript; charset=utf-8 12.6327ms
2025-12-08 21:28:07.309 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_vs/browserLink - 200 null text/javascript; charset=UTF-8 245.199ms
2025-12-08 21:28:07.526 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - null null
2025-12-08 21:28:07.696 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 170.4066ms
2025-12-08 21:29:44.880 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Auth/register - application/json 80
2025-12-08 21:29:44.903 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 21:29:44.975 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(CleanArium.Contracts.Auth.RegisterRequest) on controller CleanArium.Controllers.AuthController (CleanArium).
2025-12-08 21:29:44.985 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-12-08 21:29:45.551 +02:00 [INF] Executed DbCommand (243ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 21:29:45.580 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 21:29:45.957 +02:00 [INF] Executed DbCommand (56ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Boolean), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Users] ([Email], [IsBlocked], [LastLoginAt], [PasswordHash], [Role], [Salt], [UserName])
OUTPUT INSERTED.[Id], INSERTED.[CreatedAt]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-12-08 21:29:46.146 +02:00 [INF] Executed DbCommand (40ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[RefreshTokens] ([ExpiresAt], [IsRevoked], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 21:29:46.153 +02:00 [INF] Successful registration for user: 3 
2025-12-08 21:29:46.175 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Auth.AuthResponseDto'.
2025-12-08 21:29:46.189 +02:00 [INF] Executed action CleanArium.Controllers.AuthController.Register (CleanArium) in 1207.9027ms
2025-12-08 21:29:46.197 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 21:29:46.207 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Auth/register - 200 null application/json; charset=utf-8 1327.4711ms
2025-12-08 21:30:45.386 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Auth/register - application/json 86
2025-12-08 21:30:45.399 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 21:30:45.401 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(CleanArium.Contracts.Auth.RegisterRequest) on controller CleanArium.Controllers.AuthController (CleanArium).
2025-12-08 21:30:45.421 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 21:30:45.424 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 21:30:45.430 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Boolean), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Users] ([Email], [IsBlocked], [LastLoginAt], [PasswordHash], [Role], [Salt], [UserName])
OUTPUT INSERTED.[Id], INSERTED.[CreatedAt]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-12-08 21:30:45.438 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[RefreshTokens] ([ExpiresAt], [IsRevoked], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 21:30:45.439 +02:00 [INF] Successful registration for user: 4 
2025-12-08 21:30:45.439 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Auth.AuthResponseDto'.
2025-12-08 21:30:45.440 +02:00 [INF] Executed action CleanArium.Controllers.AuthController.Register (CleanArium) in 39.2322ms
2025-12-08 21:30:45.440 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 21:30:45.441 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Auth/register - 200 null application/json; charset=utf-8 61.2192ms
2025-12-08 21:31:17.394 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Auth/login - application/json 61
2025-12-08 21:31:17.396 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AuthController.Login (CleanArium)'
2025-12-08 21:31:17.416 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CleanArium.Contracts.Auth.LoginRequest) on controller CleanArium.Controllers.AuthController (CleanArium).
2025-12-08 21:31:17.440 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 21:31:17.446 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 21:31:17.454 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[RefreshTokens] ([ExpiresAt], [IsRevoked], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 21:31:17.454 +02:00 [INF] Successful login for user: 1 
2025-12-08 21:31:17.476 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@p8='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (Size = 255), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CleanArium].[Users] SET [CreatedAt] = @p0, [Email] = @p1, [IsBlocked] = @p2, [LastLoginAt] = @p3, [PasswordHash] = @p4, [Role] = @p5, [Salt] = @p6, [UserName] = @p7
OUTPUT 1
WHERE [Id] = @p8;
2025-12-08 21:31:17.480 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Auth.AuthResponseDto'.
2025-12-08 21:31:17.481 +02:00 [INF] Executed action CleanArium.Controllers.AuthController.Login (CleanArium) in 64.5019ms
2025-12-08 21:31:17.481 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AuthController.Login (CleanArium)'
2025-12-08 21:31:17.481 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Auth/login - 200 null application/json; charset=utf-8 86.7461ms
2025-12-08 21:32:01.747 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/User/all-users - null null
2025-12-08 21:32:01.894 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.UserController.GetAllUsers (CleanArium)'
2025-12-08 21:32:01.902 +02:00 [INF] Route matched with {action = "GetAllUsers", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllUsers(System.Threading.CancellationToken) on controller CleanArium.Controllers.UserController (CleanArium).
2025-12-08 21:32:01.929 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Role] = 1
2025-12-08 21:32:01.931 +02:00 [INF] Retrieved all users: 3
2025-12-08 21:32:01.934 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.Users.PreviewUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 21:32:01.952 +02:00 [INF] Executed action CleanArium.Controllers.UserController.GetAllUsers (CleanArium) in 50.1631ms
2025-12-08 21:32:01.952 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.UserController.GetAllUsers (CleanArium)'
2025-12-08 21:32:01.952 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/User/all-users - 200 null application/json; charset=utf-8 205.2439ms
2025-12-08 21:32:14.745 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/User/inactive-users/10 - null null
2025-12-08 21:32:14.763 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.UserController.GetInactiveUsers (CleanArium)'
2025-12-08 21:32:14.772 +02:00 [INF] Route matched with {action = "GetInactiveUsers", controller = "User"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetInactiveUsers(System.Threading.CancellationToken, Int32) on controller CleanArium.Controllers.UserController (CleanArium).
2025-12-08 21:32:14.945 +02:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-12-08 21:32:14.995 +02:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName], [t].[Id], [t].[CreatedAt], [t].[IsActive], [t].[Location], [t].[Name], [t].[UserId], [t].[Id0], [t].[AquariumId], [t].[DeviceStatus], [t].[DeviceType]
FROM [CleanArium].[Users] AS [u]
LEFT JOIN (
    SELECT [a].[Id], [a].[CreatedAt], [a].[IsActive], [a].[Location], [a].[Name], [a].[UserId], [d].[Id] AS [Id0], [d].[AquariumId], [d].[DeviceStatus], [d].[DeviceType]
    FROM [CleanArium].[Aquariums] AS [a]
    LEFT JOIN [CleanArium].[Devices] AS [d] ON [a].[Id] = [d].[AquariumId]
) AS [t] ON [u].[Id] = [t].[UserId]
WHERE [u].[Role] = 1
ORDER BY [u].[Id], [t].[Id]
2025-12-08 21:32:15.072 +02:00 [INF] Found 0 inactive users
2025-12-08 21:32:15.072 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.Users.InactiveUserDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 21:32:15.074 +02:00 [INF] Executed action CleanArium.Controllers.UserController.GetInactiveUsers (CleanArium) in 301.4134ms
2025-12-08 21:32:15.074 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.UserController.GetInactiveUsers (CleanArium)'
2025-12-08 21:32:15.074 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/User/inactive-users/10 - 200 null application/json; charset=utf-8 329.1323ms
2025-12-08 21:33:04.745 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Admin/4/make-moderator - null 0
2025-12-08 21:33:04.749 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.MakeModerator (CleanArium)'
2025-12-08 21:33:04.755 +02:00 [INF] Route matched with {action = "MakeModerator", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MakeModerator(Int64) on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 21:33:04.813 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 21:33:04.846 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Role]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Id] = @__id_0
2025-12-08 21:33:04.871 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Id] = @__id_0
2025-12-08 21:33:04.879 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p8='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (Size = 255), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CleanArium].[Users] SET [CreatedAt] = @p0, [Email] = @p1, [IsBlocked] = @p2, [LastLoginAt] = @p3, [PasswordHash] = @p4, [Role] = @p5, [Salt] = @p6, [UserName] = @p7
OUTPUT 1
WHERE [Id] = @p8;
2025-12-08 21:33:04.884 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-12-08 21:33:04.884 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.MakeModerator (CleanArium) in 129.709ms
2025-12-08 21:33:04.884 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.MakeModerator (CleanArium)'
2025-12-08 21:33:04.885 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Admin/4/make-moderator - 200 null text/plain; charset=utf-8 139.7994ms
2025-12-08 21:33:13.412 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Admin/moderators - null null
2025-12-08 21:33:13.414 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.GetModerators (CleanArium)'
2025-12-08 21:33:13.419 +02:00 [INF] Route matched with {action = "GetModerators", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetModerators() on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 21:33:13.437 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Role] = 2
2025-12-08 21:33:13.439 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.Users.ModeratorDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 21:33:13.447 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.GetModerators (CleanArium) in 27.2335ms
2025-12-08 21:33:13.447 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.GetModerators (CleanArium)'
2025-12-08 21:33:13.447 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Admin/moderators - 200 null application/json; charset=utf-8 35.6227ms
2025-12-08 21:33:23.619 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Admin/system-settings - null null
2025-12-08 21:33:23.621 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.Get (CleanArium)'
2025-12-08 21:33:23.628 +02:00 [INF] Route matched with {action = "Get", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[Application.DTOs.SystemSettings.SystemSettingsDto]] Get() on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 21:33:23.637 +02:00 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-12-08 21:33:23.652 +02:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[MaxAlarmRulesPerDevice], [s].[MaxAquariumsPerUser], [s].[MaxDevicesPerAquarium], [s].[MaxScheduledCommandsPerDevice]
FROM [CleanArium].[SystemSettings] AS [s]
2025-12-08 21:33:23.686 +02:00 [ERR] Failed executing DbCommand (21ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[SystemSettings] ([Id], [MaxAlarmRulesPerDevice], [MaxAquariumsPerUser], [MaxDevicesPerAquarium], [MaxScheduledCommandsPerDevice])
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-12-08 21:33:23.860 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Persistence.Application.CleanAriumDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'SystemSettings' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:aede74b9-5af9-406d-bab1-da8e9f6afb31
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'SystemSettings' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:aede74b9-5af9-406d-bab1-da8e9f6afb31
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-12-08 21:33:24.426 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.Get (CleanArium) in 798.1403ms
2025-12-08 21:33:24.428 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.Get (CleanArium)'
2025-12-08 21:33:24.724 +02:00 [ERR] Unhandled exception
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'SystemSettings' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:aede74b9-5af9-406d-bab1-da8e9f6afb31
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Persistence.Repositories.SystemSettingsRepository.GetAsync() in C:\Users\User\source\repos\CleanArium\Persistence\Repositories\SystemSettingsRepository.cs:line 32
   at Application.SystemSettings.Queries.GetAll.GetSystemSettingsQueryHandler.Handle(GetSystemSettingsQuery request, CancellationToken ct) in C:\Users\User\source\repos\CleanArium\Application\SystemSettings\Queries\GetAll\GetSystemSettingsQueryHandler.cs:line 18
   at CleanArium.Extensions.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\User\source\repos\CleanArium\CleanArium\Extensions\ValidationBehavior.cs:line 37
   at CleanArium.Controllers.AdminController.Get() in C:\Users\User\source\repos\CleanArium\CleanArium\Controllers\AdminController.cs:line 68
   at lambda_method392(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at CleanArium.Middleware.ExceptionMiddleware.Invoke(HttpContext context) in C:\Users\User\source\repos\CleanArium\CleanArium\Middleware\ExceptionMiddleware.cs:line 18
2025-12-08 21:33:24.778 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Admin/system-settings - 500 null application/json; charset=utf-8 1159.2792ms
2025-12-08 22:12:14.062 +02:00 [INF] Executed DbCommand (64ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 22:12:14.291 +02:00 [INF] Executed DbCommand (110ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-08 22:12:14.295 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 22:12:14.296 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-08 22:12:14.436 +02:00 [INF] Executed DbCommand (107ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-08 22:12:14.469 +02:00 [INF] No migrations were applied. The database is already up to date.
2025-12-08 22:12:14.478 +02:00 [INF] Checking if admin user exists...
2025-12-08 22:12:16.238 +02:00 [INF] Executed DbCommand (1,022ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Role] = 3
2025-12-08 22:12:16.482 +02:00 [INF] Admin already exists. Skipping seeding.
2025-12-08 22:12:17.124 +02:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-12-08 22:12:17.155 +02:00 [INF] Refresh token cleanup service started.
2025-12-08 22:12:17.226 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[ExpiresAt], [r].[IsRevoked], [r].[Token], [r].[UserId]
FROM [CleanArium].[RefreshTokens] AS [r]
WHERE [r].[ExpiresAt] < GETUTCDATE()
2025-12-08 22:12:17.696 +02:00 [INF] Now listening on: https://localhost:7085
2025-12-08 22:12:17.696 +02:00 [INF] Now listening on: http://localhost:5250
2025-12-08 22:12:17.922 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-08 22:12:17.923 +02:00 [INF] Hosting environment: Development
2025-12-08 22:12:17.923 +02:00 [INF] Content root path: C:\Users\User\source\repos\CleanArium\CleanArium
2025-12-08 22:12:19.801 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/index.html - null null
2025-12-08 22:12:20.906 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/index.html - 200 null text/html;charset=utf-8 1128.9021ms
2025-12-08 22:12:20.975 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_vs/browserLink - null null
2025-12-08 22:12:20.979 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - null null
2025-12-08 22:12:21.002 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - 200 13756 application/javascript; charset=utf-8 22.6694ms
2025-12-08 22:12:21.766 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_vs/browserLink - 200 null text/javascript; charset=UTF-8 790.9687ms
2025-12-08 22:12:22.106 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - null null
2025-12-08 22:12:22.207 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 101.4668ms
2025-12-08 22:13:24.630 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Auth/login - application/json 61
2025-12-08 22:13:24.647 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AuthController.Login (CleanArium)'
2025-12-08 22:13:24.712 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CleanArium.Contracts.Auth.LoginRequest) on controller CleanArium.Controllers.AuthController (CleanArium).
2025-12-08 22:13:24.723 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-12-08 22:13:25.171 +02:00 [INF] Executed DbCommand (96ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 22:13:25.196 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 22:13:25.644 +02:00 [INF] Executed DbCommand (134ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[RefreshTokens] ([ExpiresAt], [IsRevoked], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 22:13:25.675 +02:00 [INF] Successful login for user: 1 
2025-12-08 22:13:25.705 +02:00 [INF] Executed DbCommand (22ms) [Parameters=[@p8='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (Size = 255), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CleanArium].[Users] SET [CreatedAt] = @p0, [Email] = @p1, [IsBlocked] = @p2, [LastLoginAt] = @p3, [PasswordHash] = @p4, [Role] = @p5, [Salt] = @p6, [UserName] = @p7
OUTPUT 1
WHERE [Id] = @p8;
2025-12-08 22:13:25.723 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Auth.AuthResponseDto'.
2025-12-08 22:13:25.733 +02:00 [INF] Executed action CleanArium.Controllers.AuthController.Login (CleanArium) in 1015.2005ms
2025-12-08 22:13:25.734 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AuthController.Login (CleanArium)'
2025-12-08 22:13:25.741 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Auth/login - 200 null application/json; charset=utf-8 1110.8701ms
2025-12-08 22:13:39.460 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Admin/logs - null null
2025-12-08 22:13:39.580 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.GetLogs (CleanArium)'
2025-12-08 22:13:39.584 +02:00 [INF] Route matched with {action = "GetLogs", controller = "Admin"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetLogs() on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 22:13:39.588 +02:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.String'.
2025-12-08 22:13:39.588 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.GetLogs (CleanArium) in 3.7012ms
2025-12-08 22:13:39.588 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.GetLogs (CleanArium)'
2025-12-08 22:13:39.589 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Admin/logs - 404 null text/plain; charset=utf-8 129.0519ms
2025-12-08 22:14:28.783 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Admin/system-settings - null null
2025-12-08 22:14:28.790 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.Get (CleanArium)'
2025-12-08 22:14:28.794 +02:00 [INF] Route matched with {action = "Get", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get() on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 22:14:28.802 +02:00 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-12-08 22:14:28.824 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[MaxAlarmRulesPerDevice], [s].[MaxAquariumsPerUser], [s].[MaxDevicesPerAquarium], [s].[MaxScheduledCommandsPerDevice]
FROM [CleanArium].[SystemSettings] AS [s]
2025-12-08 22:14:28.881 +02:00 [ERR] Failed executing DbCommand (38ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[SystemSettings] ([Id], [MaxAlarmRulesPerDevice], [MaxAquariumsPerUser], [MaxDevicesPerAquarium], [MaxScheduledCommandsPerDevice])
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-12-08 22:14:28.964 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Persistence.Application.CleanAriumDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'SystemSettings' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:4cc60738-0978-417e-9f5a-0758e70ff86a
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'SystemSettings' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:4cc60738-0978-417e-9f5a-0758e70ff86a
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-12-08 22:14:29.721 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.Get (CleanArium) in 926.6483ms
2025-12-08 22:14:29.722 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.Get (CleanArium)'
2025-12-08 22:14:30.004 +02:00 [ERR] Unhandled exception
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'SystemSettings' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:4cc60738-0978-417e-9f5a-0758e70ff86a
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Persistence.Repositories.SystemSettingsRepository.GetAsync() in C:\Users\User\source\repos\CleanArium\Persistence\Repositories\SystemSettingsRepository.cs:line 32
   at Application.SystemSettings.Queries.GetAll.GetSystemSettingsQueryHandler.Handle(GetSystemSettingsQuery request, CancellationToken ct) in C:\Users\User\source\repos\CleanArium\Application\SystemSettings\Queries\GetAll\GetSystemSettingsQueryHandler.cs:line 18
   at CleanArium.Extensions.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\User\source\repos\CleanArium\CleanArium\Extensions\ValidationBehavior.cs:line 37
   at CleanArium.Controllers.AdminController.Get() in C:\Users\User\source\repos\CleanArium\CleanArium\Controllers\AdminController.cs:line 69
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at CleanArium.Middleware.ExceptionMiddleware.Invoke(HttpContext context) in C:\Users\User\source\repos\CleanArium\CleanArium\Middleware\ExceptionMiddleware.cs:line 18
2025-12-08 22:14:30.065 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Admin/system-settings - 500 null application/json; charset=utf-8 1281.7887ms
2025-12-08 22:15:05.788 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Admin/moderators - null null
2025-12-08 22:15:05.877 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.GetModerators (CleanArium)'
2025-12-08 22:15:05.884 +02:00 [INF] Route matched with {action = "GetModerators", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetModerators() on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 22:15:05.979 +02:00 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Role] = 2
2025-12-08 22:15:05.983 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.Users.ModeratorDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 22:15:06.016 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.GetModerators (CleanArium) in 132.4377ms
2025-12-08 22:15:06.016 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.GetModerators (CleanArium)'
2025-12-08 22:15:06.017 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Admin/moderators - 200 null application/json; charset=utf-8 228.7984ms
2025-12-08 22:15:28.601 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/SupportMessage/get-all-for-admin - null null
2025-12-08 22:15:28.605 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.SupportMessageController.GetAllForAdmin (CleanArium)'
2025-12-08 22:15:28.612 +02:00 [INF] Route matched with {action = "GetAllForAdmin", controller = "SupportMessage"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllForAdmin(System.Threading.CancellationToken) on controller CleanArium.Controllers.SupportMessageController (CleanArium).
2025-12-08 22:15:28.707 +02:00 [INF] Executed DbCommand (70ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[CreatedAt], [s].[IsFirst], [s].[Message], [s].[MessageStatus], [s].[ReplyToMessageId], [s].[Sender], [s].[Subject], [s].[UserId]
FROM [CleanArium].[SupportMessages] AS [s]
WHERE [s].[Sender] <> 3 AND [s].[MessageStatus] = 1 AND [s].[IsFirst] = CAST(1 AS bit)
2025-12-08 22:15:28.738 +02:00 [INF] Successfully retrieved messages for Admin.
2025-12-08 22:15:28.739 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.SupportMessages.PreviewSupportMessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 22:15:28.741 +02:00 [INF] Executed action CleanArium.Controllers.SupportMessageController.GetAllForAdmin (CleanArium) in 129.3781ms
2025-12-08 22:15:28.741 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.SupportMessageController.GetAllForAdmin (CleanArium)'
2025-12-08 22:15:28.742 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/SupportMessage/get-all-for-admin - 200 null application/json; charset=utf-8 141.1897ms
2025-12-08 22:16:25.536 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/SupportMessage/reply - application/json 120
2025-12-08 22:16:25.542 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.SupportMessageController.Reply (CleanArium)'
2025-12-08 22:16:25.550 +02:00 [INF] Route matched with {action = "Reply", controller = "SupportMessage"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Reply(CleanArium.Contracts.SupportMessages.ReplyMessageRequest, System.Threading.CancellationToken) on controller CleanArium.Controllers.SupportMessageController (CleanArium).
2025-12-08 22:16:26.097 +02:00 [INF] Executed DbCommand (436ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 22:16:26.280 +02:00 [INF] Executed DbCommand (175ms) [Parameters=[@__messageId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[SupportMessages] AS [s]
        WHERE [s].[Id] = @__messageId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 22:16:26.337 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Role]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Id] = @__id_0
2025-12-08 22:16:26.541 +02:00 [INF] Executed DbCommand (170ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 400), @p3='?' (DbType = Int32), @p4='?' (DbType = Int64), @p5='?' (DbType = Int32), @p6='?' (Size = 80), @p7='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[SupportMessages] ([CreatedAt], [IsFirst], [Message], [MessageStatus], [ReplyToMessageId], [Sender], [Subject], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-12-08 22:16:26.546 +02:00 [INF] SupportMessage created replying to message: 1
2025-12-08 22:16:26.548 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Int64'.
2025-12-08 22:16:26.551 +02:00 [INF] Executed action CleanArium.Controllers.SupportMessageController.Reply (CleanArium) in 1000.7438ms
2025-12-08 22:16:26.551 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.SupportMessageController.Reply (CleanArium)'
2025-12-08 22:16:26.551 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/SupportMessage/reply - 200 null application/json; charset=utf-8 1015.1796ms
2025-12-08 22:16:32.628 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/SupportMessage/get-all-for-admin - null null
2025-12-08 22:16:32.629 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.SupportMessageController.GetAllForAdmin (CleanArium)'
2025-12-08 22:16:32.629 +02:00 [INF] Route matched with {action = "GetAllForAdmin", controller = "SupportMessage"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllForAdmin(System.Threading.CancellationToken) on controller CleanArium.Controllers.SupportMessageController (CleanArium).
2025-12-08 22:16:32.638 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[CreatedAt], [s].[IsFirst], [s].[Message], [s].[MessageStatus], [s].[ReplyToMessageId], [s].[Sender], [s].[Subject], [s].[UserId]
FROM [CleanArium].[SupportMessages] AS [s]
WHERE [s].[Sender] <> 3 AND [s].[MessageStatus] = 1 AND [s].[IsFirst] = CAST(1 AS bit)
2025-12-08 22:16:32.639 +02:00 [INF] Successfully retrieved messages for Admin.
2025-12-08 22:16:32.639 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.SupportMessages.PreviewSupportMessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 22:16:32.640 +02:00 [INF] Executed action CleanArium.Controllers.SupportMessageController.GetAllForAdmin (CleanArium) in 10.5739ms
2025-12-08 22:16:32.640 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.SupportMessageController.GetAllForAdmin (CleanArium)'
2025-12-08 22:16:32.641 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/SupportMessage/get-all-for-admin - 200 null application/json; charset=utf-8 12.5966ms
2025-12-08 22:16:41.123 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/SupportMessage/get-history/1 - null null
2025-12-08 22:16:41.124 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.SupportMessageController.GetHistoryByFirstMessageId (CleanArium)'
2025-12-08 22:16:41.175 +02:00 [INF] Route matched with {action = "GetHistoryByFirstMessageId", controller = "SupportMessage"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetHistoryByFirstMessageId(Int64, System.Threading.CancellationToken) on controller CleanArium.Controllers.SupportMessageController (CleanArium).
2025-12-08 22:16:41.197 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 22:16:41.216 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__messageId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[SupportMessages] AS [s]
        WHERE [s].[Id] = @__messageId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 22:16:41.220 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Role]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Id] = @__id_0
2025-12-08 22:16:41.240 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[@__messageId_0='?' (DbType = Int64), @__userId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[SupportMessages] AS [s]
        WHERE [s].[Id] = @__messageId_0 AND [s].[UserId] = @__userId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 22:16:41.254 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[CreatedAt], [s].[IsFirst], [s].[Message], [s].[MessageStatus], [s].[ReplyToMessageId], [s].[Sender], [s].[Subject], [s].[UserId]
FROM [CleanArium].[SupportMessages] AS [s]
WHERE [s].[Id] = @__id_0
2025-12-08 22:16:41.257 +02:00 [INF] Successfully retrieved history of messages where first: 1 
2025-12-08 22:16:41.257 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.SupportMessages.SupportMessageDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 22:16:41.272 +02:00 [INF] Executed action CleanArium.Controllers.SupportMessageController.GetHistoryByFirstMessageId (CleanArium) in 96.7847ms
2025-12-08 22:16:41.272 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.SupportMessageController.GetHistoryByFirstMessageId (CleanArium)'
2025-12-08 22:16:41.272 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/SupportMessage/get-history/1 - 200 null application/json; charset=utf-8 149.567ms
2025-12-08 23:42:24.767 +02:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 23:42:24.978 +02:00 [INF] Executed DbCommand (84ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-08 23:42:24.982 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 23:42:24.983 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-08 23:42:25.080 +02:00 [INF] Executed DbCommand (70ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-08 23:42:25.109 +02:00 [INF] Applying migration '20251208213755_Init'.
2025-12-08 23:42:25.507 +02:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF SCHEMA_ID(N'CleanArium') IS NULL EXEC(N'CREATE SCHEMA [CleanArium];');
2025-12-08 23:42:25.627 +02:00 [ERR] Failed executing DbCommand (118ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[SystemSettings] (
    [Id] bigint NOT NULL IDENTITY,
    [MaxAquariumsPerUser] int NOT NULL,
    [MaxDevicesPerAquarium] int NOT NULL,
    [MaxAlarmRulesPerDevice] int NOT NULL,
    [MaxScheduledCommandsPerDevice] int NOT NULL,
    CONSTRAINT [PK_SystemSettings] PRIMARY KEY ([Id])
);
2025-12-08 23:42:27.392 +02:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-12-08 23:42:27.432 +02:00 [INF] Refresh token cleanup service started.
2025-12-08 23:42:29.031 +02:00 [INF] Executed DbCommand (156ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[ExpiresAt], [r].[IsRevoked], [r].[Token], [r].[UserId]
FROM [CleanArium].[RefreshTokens] AS [r]
WHERE [r].[ExpiresAt] < GETUTCDATE()
2025-12-08 23:42:29.189 +02:00 [INF] Now listening on: https://localhost:7085
2025-12-08 23:42:29.189 +02:00 [INF] Now listening on: http://localhost:5250
2025-12-08 23:42:29.537 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-08 23:42:29.537 +02:00 [INF] Hosting environment: Development
2025-12-08 23:42:29.538 +02:00 [INF] Content root path: C:\Users\User\source\repos\CleanArium\CleanArium
2025-12-08 23:42:31.821 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/index.html - null null
2025-12-08 23:42:32.992 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/index.html - 200 null text/html;charset=utf-8 1201.1043ms
2025-12-08 23:42:33.107 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - null null
2025-12-08 23:42:33.121 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_vs/browserLink - null null
2025-12-08 23:42:33.137 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - 200 13756 application/javascript; charset=utf-8 31.1476ms
2025-12-08 23:42:33.341 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_vs/browserLink - 200 null text/javascript; charset=UTF-8 219.6118ms
2025-12-08 23:42:33.581 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - null null
2025-12-08 23:42:33.702 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 121.1901ms
2025-12-08 23:44:13.800 +02:00 [INF] Executed DbCommand (492ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [CleanAriumDb];
2025-12-08 23:44:14.030 +02:00 [INF] Executed DbCommand (161ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [CleanAriumDb] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-12-08 23:44:14.098 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 23:44:14.211 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-12-08 23:44:14.213 +02:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-12-08 23:44:14.236 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-12-08 23:44:14.255 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-12-08 23:44:14.284 +02:00 [INF] Applying migration '20251208213755_Init'.
2025-12-08 23:44:14.410 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF SCHEMA_ID(N'CleanArium') IS NULL EXEC(N'CREATE SCHEMA [CleanArium];');
2025-12-08 23:44:14.415 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[SystemSettings] (
    [Id] bigint NOT NULL IDENTITY,
    [MaxAquariumsPerUser] int NOT NULL,
    [MaxDevicesPerAquarium] int NOT NULL,
    [MaxAlarmRulesPerDevice] int NOT NULL,
    [MaxScheduledCommandsPerDevice] int NOT NULL,
    CONSTRAINT [PK_SystemSettings] PRIMARY KEY ([Id])
);
2025-12-08 23:44:14.470 +02:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[Users] (
    [Id] bigint NOT NULL IDENTITY,
    [UserName] nvarchar(30) NOT NULL,
    [Email] nvarchar(255) NOT NULL,
    [PasswordHash] nvarchar(max) NOT NULL,
    [Salt] nvarchar(max) NOT NULL,
    [Role] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [IsBlocked] bit NOT NULL,
    [LastLoginAt] datetime2 NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-12-08 23:44:14.537 +02:00 [INF] Executed DbCommand (68ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[Aquariums] (
    [Id] bigint NOT NULL IDENTITY,
    [UserId] bigint NOT NULL,
    [Name] nvarchar(30) NOT NULL,
    [Location] nvarchar(80) NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_Aquariums] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Aquariums_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [CleanArium].[Users] ([Id]) ON DELETE CASCADE
);
2025-12-08 23:44:14.551 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[PasswordResetTokens] (
    [Id] bigint NOT NULL IDENTITY,
    [UserId] bigint NOT NULL,
    [Token] nvarchar(max) NOT NULL,
    [ExpiresAt] datetime2 NOT NULL,
    [IsUsed] bit NOT NULL,
    CONSTRAINT [PK_PasswordResetTokens] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_PasswordResetTokens_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [CleanArium].[Users] ([Id]) ON DELETE CASCADE
);
2025-12-08 23:44:14.563 +02:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[RefreshTokens] (
    [Id] bigint NOT NULL IDENTITY,
    [UserId] bigint NOT NULL,
    [Token] nvarchar(max) NOT NULL,
    [ExpiresAt] datetime2 NOT NULL,
    [IsRevoked] bit NOT NULL,
    CONSTRAINT [PK_RefreshTokens] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_RefreshTokens_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [CleanArium].[Users] ([Id]) ON DELETE CASCADE
);
2025-12-08 23:44:14.571 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[SupportMessages] (
    [Id] bigint NOT NULL IDENTITY,
    [UserId] bigint NOT NULL,
    [ReplyToMessageId] bigint NULL,
    [Sender] int NOT NULL,
    [Subject] nvarchar(80) NOT NULL,
    [Message] nvarchar(400) NOT NULL,
    [MessageStatus] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_SupportMessages] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_SupportMessages_SupportMessages_ReplyToMessageId] FOREIGN KEY ([ReplyToMessageId]) REFERENCES [CleanArium].[SupportMessages] ([Id]),
    CONSTRAINT [FK_SupportMessages_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [CleanArium].[Users] ([Id]) ON DELETE CASCADE
);
2025-12-08 23:44:14.574 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[Devices] (
    [Id] bigint NOT NULL IDENTITY,
    [AquariumId] bigint NOT NULL,
    [DeviceType] int NOT NULL,
    [DeviceStatus] int NOT NULL,
    CONSTRAINT [PK_Devices] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Devices_Aquariums_AquariumId] FOREIGN KEY ([AquariumId]) REFERENCES [CleanArium].[Aquariums] ([Id]) ON DELETE CASCADE
);
2025-12-08 23:44:14.579 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[AlarmRules] (
    [Id] bigint NOT NULL IDENTITY,
    [DeviceId] bigint NOT NULL,
    [Condition] int NOT NULL,
    [Threshold] real NOT NULL,
    [Unit] nvarchar(max) NOT NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_AlarmRules] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AlarmRules_Devices_DeviceId] FOREIGN KEY ([DeviceId]) REFERENCES [CleanArium].[Devices] ([Id]) ON DELETE CASCADE
);
2025-12-08 23:44:14.582 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[ExecutedCommands] (
    [Id] bigint NOT NULL IDENTITY,
    [DeviceId] bigint NOT NULL,
    [CommandType] int NOT NULL,
    [CommandStatus] int NOT NULL,
    [IssuedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_ExecutedCommands] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ExecutedCommands_Devices_DeviceId] FOREIGN KEY ([DeviceId]) REFERENCES [CleanArium].[Devices] ([Id]) ON DELETE CASCADE
);
2025-12-08 23:44:14.586 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[ScheduledCommands] (
    [Id] bigint NOT NULL IDENTITY,
    [DeviceId] bigint NOT NULL,
    [CommandType] int NOT NULL,
    [StartTime] datetime2 NOT NULL,
    [RepeatMode] int NOT NULL,
    [IntervalMinutes] int NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_ScheduledCommands] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_ScheduledCommands_Devices_DeviceId] FOREIGN KEY ([DeviceId]) REFERENCES [CleanArium].[Devices] ([Id]) ON DELETE CASCADE
);
2025-12-08 23:44:14.589 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[SensorData] (
    [Id] bigint NOT NULL IDENTITY,
    [DeviceId] bigint NOT NULL,
    [Value] real NOT NULL,
    [Unit] nvarchar(max) NOT NULL,
    [DateTime] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    CONSTRAINT [PK_SensorData] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_SensorData_Devices_DeviceId] FOREIGN KEY ([DeviceId]) REFERENCES [CleanArium].[Devices] ([Id]) ON DELETE CASCADE
);
2025-12-08 23:44:14.595 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [CleanArium].[Notifications] (
    [Id] bigint NOT NULL IDENTITY,
    [UserId] bigint NOT NULL,
    [Title] nvarchar(80) NOT NULL,
    [Content] nvarchar(400) NOT NULL,
    [IsRead] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETUTCDATE()),
    [AlarmRuleId] bigint NULL,
    [ScheduledCommandId] bigint NULL,
    CONSTRAINT [PK_Notifications] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Notifications_AlarmRules_AlarmRuleId] FOREIGN KEY ([AlarmRuleId]) REFERENCES [CleanArium].[AlarmRules] ([Id]),
    CONSTRAINT [FK_Notifications_ScheduledCommands_ScheduledCommandId] FOREIGN KEY ([ScheduledCommandId]) REFERENCES [CleanArium].[ScheduledCommands] ([Id]),
    CONSTRAINT [FK_Notifications_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [CleanArium].[Users] ([Id]) ON DELETE CASCADE
);
2025-12-08 23:44:14.601 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AlarmRules_DeviceId] ON [CleanArium].[AlarmRules] ([DeviceId]);
2025-12-08 23:44:14.602 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Aquariums_UserId] ON [CleanArium].[Aquariums] ([UserId]);
2025-12-08 23:44:14.603 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Devices_AquariumId] ON [CleanArium].[Devices] ([AquariumId]);
2025-12-08 23:44:14.604 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ExecutedCommands_DeviceId] ON [CleanArium].[ExecutedCommands] ([DeviceId]);
2025-12-08 23:44:14.606 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_AlarmRuleId] ON [CleanArium].[Notifications] ([AlarmRuleId]);
2025-12-08 23:44:14.608 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_ScheduledCommandId] ON [CleanArium].[Notifications] ([ScheduledCommandId]);
2025-12-08 23:44:14.610 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_UserId] ON [CleanArium].[Notifications] ([UserId]);
2025-12-08 23:44:14.613 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetTokens_UserId] ON [CleanArium].[PasswordResetTokens] ([UserId]);
2025-12-08 23:44:14.615 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_RefreshTokens_UserId] ON [CleanArium].[RefreshTokens] ([UserId]);
2025-12-08 23:44:14.616 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_ScheduledCommands_DeviceId] ON [CleanArium].[ScheduledCommands] ([DeviceId]);
2025-12-08 23:44:14.618 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_SensorData_DeviceId] ON [CleanArium].[SensorData] ([DeviceId]);
2025-12-08 23:44:14.620 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_SupportMessages_ReplyToMessageId] ON [CleanArium].[SupportMessages] ([ReplyToMessageId]);
2025-12-08 23:44:14.621 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_SupportMessages_UserId] ON [CleanArium].[SupportMessages] ([UserId]);
2025-12-08 23:44:14.635 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20251208213755_Init', N'8.0.18');
2025-12-08 23:44:14.650 +02:00 [INF] Checking if admin user exists...
2025-12-08 23:44:15.240 +02:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Role] = 3
2025-12-08 23:44:15.254 +02:00 [INF] Admin does not exist. Creating default admin...
2025-12-08 23:44:15.653 +02:00 [INF] Executed DbCommand (49ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 255), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Users] ([CreatedAt], [Email], [IsBlocked], [LastLoginAt], [PasswordHash], [Role], [Salt], [UserName])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-12-08 23:44:15.691 +02:00 [INF] Admin user created successfully.
2025-12-08 23:44:16.014 +02:00 [INF] User profile is available. Using 'C:\Users\User\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-12-08 23:44:16.051 +02:00 [INF] Refresh token cleanup service started.
2025-12-08 23:44:16.239 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[ExpiresAt], [r].[IsRevoked], [r].[Token], [r].[UserId]
FROM [CleanArium].[RefreshTokens] AS [r]
WHERE [r].[ExpiresAt] < GETUTCDATE()
2025-12-08 23:44:16.685 +02:00 [INF] Now listening on: https://localhost:7085
2025-12-08 23:44:16.685 +02:00 [INF] Now listening on: http://localhost:5250
2025-12-08 23:44:17.007 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-12-08 23:44:17.007 +02:00 [INF] Hosting environment: Development
2025-12-08 23:44:17.008 +02:00 [INF] Content root path: C:\Users\User\source\repos\CleanArium\CleanArium
2025-12-08 23:44:18.492 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/index.html - null null
2025-12-08 23:44:19.644 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/index.html - 200 null text/html;charset=utf-8 1173.9466ms
2025-12-08 23:44:20.010 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - null null
2025-12-08 23:44:20.011 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/_vs/browserLink - null null
2025-12-08 23:44:20.037 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_framework/aspnetcore-browser-refresh.js - 200 13756 application/javascript; charset=utf-8 25.321ms
2025-12-08 23:44:20.598 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/_vs/browserLink - 200 null text/javascript; charset=UTF-8 586.6111ms
2025-12-08 23:44:20.924 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - null null
2025-12-08 23:44:21.129 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 205.0734ms
2025-12-08 23:46:01.406 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Auth/register - application/json 83
2025-12-08 23:46:01.592 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 23:46:01.826 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(CleanArium.Contracts.Auth.RegisterRequest) on controller CleanArium.Controllers.AuthController (CleanArium).
2025-12-08 23:46:01.908 +02:00 [WRN] You do not have a valid license key for the Lucky Penny software MediatR. This is allowed for development and testing scenarios. If you are running in production you are required to have a licensed version. Please visit https://luckypennysoftware.com to obtain a valid license.
2025-12-08 23:46:03.839 +02:00 [INF] Executed DbCommand (1,103ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 23:46:03.999 +02:00 [INF] Executed DbCommand (28ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 23:46:04.265 +02:00 [INF] Executed DbCommand (163ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Boolean), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Users] ([Email], [IsBlocked], [LastLoginAt], [PasswordHash], [Role], [Salt], [UserName])
OUTPUT INSERTED.[Id], INSERTED.[CreatedAt]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-12-08 23:46:04.573 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[RefreshTokens] ([ExpiresAt], [IsRevoked], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 23:46:04.578 +02:00 [INF] Successful registration for user: 2 
2025-12-08 23:46:04.600 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Auth.AuthResponseDto'.
2025-12-08 23:46:04.629 +02:00 [INF] Executed action CleanArium.Controllers.AuthController.Register (CleanArium) in 2768.4029ms
2025-12-08 23:46:04.631 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 23:46:04.640 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Auth/register - 200 null application/json; charset=utf-8 3239.679ms
2025-12-08 23:46:35.250 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Aquarium/import - multipart/form-data; boundary=----WebKitFormBoundaryavScyPEPmWTmVDoY 349
2025-12-08 23:46:35.444 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AquariumController.ImportAquariums (CleanArium)'
2025-12-08 23:46:35.455 +02:00 [INF] Route matched with {action = "ImportAquariums", controller = "Aquarium"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ImportAquariums(Microsoft.AspNetCore.Http.IFormFile) on controller CleanArium.Controllers.AquariumController (CleanArium).
2025-12-08 23:46:35.708 +02:00 [INF] Executed DbCommand (113ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 23:46:35.828 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = Boolean), @p1='?' (Size = 80), @p2='?' (Size = 30), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Aquariums] ([IsActive], [Location], [Name], [UserId])
OUTPUT INSERTED.[Id], INSERTED.[CreatedAt]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 23:46:35.922 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Devices] ([AquariumId], [DeviceStatus], [DeviceType])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-12-08 23:46:35.933 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Devices] ([AquariumId], [DeviceStatus], [DeviceType])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-12-08 23:46:35.936 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Devices] ([AquariumId], [DeviceStatus], [DeviceType])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-12-08 23:46:35.946 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Boolean), @p1='?' (Size = 80), @p2='?' (Size = 30), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Aquariums] ([IsActive], [Location], [Name], [UserId])
OUTPUT INSERTED.[Id], INSERTED.[CreatedAt]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 23:46:35.973 +02:00 [INF] Executed DbCommand (23ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Devices] ([AquariumId], [DeviceStatus], [DeviceType])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-12-08 23:46:35.984 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Devices] ([AquariumId], [DeviceStatus], [DeviceType])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-12-08 23:46:35.990 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Boolean), @p1='?' (Size = 80), @p2='?' (Size = 30), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Aquariums] ([IsActive], [Location], [Name], [UserId])
OUTPUT INSERTED.[Id], INSERTED.[CreatedAt]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 23:46:35.996 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Devices] ([AquariumId], [DeviceStatus], [DeviceType])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-12-08 23:46:36.000 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Result.ImportResult'.
2025-12-08 23:46:36.002 +02:00 [INF] Executed action CleanArium.Controllers.AquariumController.ImportAquariums (CleanArium) in 545.8469ms
2025-12-08 23:46:36.002 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AquariumController.ImportAquariums (CleanArium)'
2025-12-08 23:46:36.003 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Aquarium/import - 200 null application/json; charset=utf-8 753.8779ms
2025-12-08 23:46:59.618 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/AlarmRule/1/import - multipart/form-data; boundary=----WebKitFormBoundary3dxNXsAxALs8tbld 289
2025-12-08 23:46:59.663 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AlarmRuleController.ImportRules (CleanArium)'
2025-12-08 23:46:59.676 +02:00 [INF] Route matched with {action = "ImportRules", controller = "AlarmRule"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ImportRules(Int64, Microsoft.AspNetCore.Http.IFormFile) on controller CleanArium.Controllers.AlarmRuleController (CleanArium).
2025-12-08 23:46:59.722 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[AquariumId], [d].[DeviceStatus], [d].[DeviceType]
FROM [CleanArium].[Devices] AS [d]
WHERE [d].[Id] = @__id_0
2025-12-08 23:46:59.804 +02:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int64), @p2='?' (DbType = Boolean), @p3='?' (DbType = Single), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[AlarmRules] ([Condition], [DeviceId], [IsActive], [Threshold], [Unit])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-12-08 23:46:59.806 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Result.ImportResult'.
2025-12-08 23:46:59.807 +02:00 [INF] Executed action CleanArium.Controllers.AlarmRuleController.ImportRules (CleanArium) in 130.4658ms
2025-12-08 23:46:59.807 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AlarmRuleController.ImportRules (CleanArium)'
2025-12-08 23:46:59.807 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/AlarmRule/1/import - 200 null application/json; charset=utf-8 191.024ms
2025-12-08 23:47:58.174 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Auth/register - application/json 81
2025-12-08 23:47:58.179 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 23:47:58.179 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(CleanArium.Contracts.Auth.RegisterRequest) on controller CleanArium.Controllers.AuthController (CleanArium).
2025-12-08 23:47:58.207 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 23:47:58.209 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 23:47:58.304 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Boolean), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Users] ([Email], [IsBlocked], [LastLoginAt], [PasswordHash], [Role], [Salt], [UserName])
OUTPUT INSERTED.[Id], INSERTED.[CreatedAt]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-12-08 23:47:58.313 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[RefreshTokens] ([ExpiresAt], [IsRevoked], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 23:47:58.317 +02:00 [INF] Successful registration for user: 3 
2025-12-08 23:47:58.318 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Auth.AuthResponseDto'.
2025-12-08 23:47:58.318 +02:00 [INF] Executed action CleanArium.Controllers.AuthController.Register (CleanArium) in 138.5059ms
2025-12-08 23:47:58.318 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 23:47:58.320 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Auth/register - 200 null application/json; charset=utf-8 145.81ms
2025-12-08 23:48:18.358 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Auth/register - application/json 86
2025-12-08 23:48:18.362 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 23:48:18.363 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(CleanArium.Contracts.Auth.RegisterRequest) on controller CleanArium.Controllers.AuthController (CleanArium).
2025-12-08 23:48:18.455 +02:00 [INF] Executed DbCommand (77ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 23:48:18.477 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 23:48:18.485 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 255), @p1='?' (DbType = Boolean), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (DbType = Int32), @p5='?' (Size = 4000), @p6='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[Users] ([Email], [IsBlocked], [LastLoginAt], [PasswordHash], [Role], [Salt], [UserName])
OUTPUT INSERTED.[Id], INSERTED.[CreatedAt]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-12-08 23:48:18.492 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[RefreshTokens] ([ExpiresAt], [IsRevoked], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 23:48:18.493 +02:00 [INF] Successful registration for user: 4 
2025-12-08 23:48:18.493 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Auth.AuthResponseDto'.
2025-12-08 23:48:18.493 +02:00 [INF] Executed action CleanArium.Controllers.AuthController.Register (CleanArium) in 130.6623ms
2025-12-08 23:48:18.493 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AuthController.Register (CleanArium)'
2025-12-08 23:48:18.494 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Auth/register - 200 null application/json; charset=utf-8 136.4827ms
2025-12-08 23:48:56.794 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Auth/login - application/json 61
2025-12-08 23:48:56.794 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AuthController.Login (CleanArium)'
2025-12-08 23:48:56.801 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(CleanArium.Contracts.Auth.LoginRequest) on controller CleanArium.Controllers.AuthController (CleanArium).
2025-12-08 23:48:56.839 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 23:48:56.849 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-12-08 23:48:56.855 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[RefreshTokens] ([ExpiresAt], [IsRevoked], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-12-08 23:48:56.856 +02:00 [INF] Successful login for user: 1 
2025-12-08 23:48:56.881 +02:00 [INF] Executed DbCommand (15ms) [Parameters=[@p8='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (Size = 255), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CleanArium].[Users] SET [CreatedAt] = @p0, [Email] = @p1, [IsBlocked] = @p2, [LastLoginAt] = @p3, [PasswordHash] = @p4, [Role] = @p5, [Salt] = @p6, [UserName] = @p7
OUTPUT 1
WHERE [Id] = @p8;
2025-12-08 23:48:56.884 +02:00 [INF] Executing OkObjectResult, writing value of type 'Application.DTOs.Auth.AuthResponseDto'.
2025-12-08 23:48:56.884 +02:00 [INF] Executed action CleanArium.Controllers.AuthController.Login (CleanArium) in 83.4321ms
2025-12-08 23:48:56.884 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AuthController.Login (CleanArium)'
2025-12-08 23:48:56.884 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Auth/login - 200 null application/json; charset=utf-8 91.2966ms
2025-12-08 23:49:13.723 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Admin/3/make-moderator - null 0
2025-12-08 23:49:13.728 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.MakeModerator (CleanArium)'
2025-12-08 23:49:13.736 +02:00 [INF] Route matched with {action = "MakeModerator", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MakeModerator(Int64) on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 23:49:13.773 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 23:49:13.809 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Role]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Id] = @__id_0
2025-12-08 23:49:13.826 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Id] = @__id_0
2025-12-08 23:49:13.833 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p8='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (Size = 255), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CleanArium].[Users] SET [CreatedAt] = @p0, [Email] = @p1, [IsBlocked] = @p2, [LastLoginAt] = @p3, [PasswordHash] = @p4, [Role] = @p5, [Salt] = @p6, [UserName] = @p7
OUTPUT 1
WHERE [Id] = @p8;
2025-12-08 23:49:13.836 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-12-08 23:49:13.837 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.MakeModerator (CleanArium) in 100.7613ms
2025-12-08 23:49:13.837 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.MakeModerator (CleanArium)'
2025-12-08 23:49:13.837 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Admin/3/make-moderator - 200 null text/plain; charset=utf-8 114.7586ms
2025-12-08 23:49:20.433 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Admin/moderators - null null
2025-12-08 23:49:20.440 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.GetModerators (CleanArium)'
2025-12-08 23:49:20.444 +02:00 [INF] Route matched with {action = "GetModerators", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetModerators() on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 23:49:20.472 +02:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Role] = 2
2025-12-08 23:49:20.475 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.Users.ModeratorDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 23:49:20.504 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.GetModerators (CleanArium) in 59.3574ms
2025-12-08 23:49:20.504 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.GetModerators (CleanArium)'
2025-12-08 23:49:20.504 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Admin/moderators - 200 null application/json; charset=utf-8 71.1393ms
2025-12-08 23:49:35.311 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Admin/4/make-moderator - null 0
2025-12-08 23:49:35.314 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.MakeModerator (CleanArium)'
2025-12-08 23:49:35.315 +02:00 [INF] Route matched with {action = "MakeModerator", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MakeModerator(Int64) on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 23:49:35.323 +02:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 23:49:35.326 +02:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Role]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Id] = @__id_0
2025-12-08 23:49:35.330 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Id] = @__id_0
2025-12-08 23:49:35.337 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@p8='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (Size = 255), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CleanArium].[Users] SET [CreatedAt] = @p0, [Email] = @p1, [IsBlocked] = @p2, [LastLoginAt] = @p3, [PasswordHash] = @p4, [Role] = @p5, [Salt] = @p6, [UserName] = @p7
OUTPUT 1
WHERE [Id] = @p8;
2025-12-08 23:49:35.338 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-12-08 23:49:35.338 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.MakeModerator (CleanArium) in 23.2636ms
2025-12-08 23:49:35.338 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.MakeModerator (CleanArium)'
2025-12-08 23:49:35.338 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Admin/4/make-moderator - 200 null text/plain; charset=utf-8 27.2155ms
2025-12-08 23:49:39.156 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Admin/moderators - null null
2025-12-08 23:49:39.157 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.GetModerators (CleanArium)'
2025-12-08 23:49:39.157 +02:00 [INF] Route matched with {action = "GetModerators", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetModerators() on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 23:49:39.168 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Role] = 2
2025-12-08 23:49:39.169 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.Users.ModeratorDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 23:49:39.169 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.GetModerators (CleanArium) in 12.772ms
2025-12-08 23:49:39.170 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.GetModerators (CleanArium)'
2025-12-08 23:49:39.170 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Admin/moderators - 200 null application/json; charset=utf-8 14.2736ms
2025-12-08 23:49:51.635 +02:00 [INF] Request starting HTTP/2 POST https://localhost:7085/api/Admin/3/remove-moderator - null 0
2025-12-08 23:49:51.636 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.RemoveModerator (CleanArium)'
2025-12-08 23:49:51.646 +02:00 [INF] Route matched with {action = "RemoveModerator", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] RemoveModerator(Int64) on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 23:49:51.665 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [CleanArium].[Users] AS [u]
        WHERE [u].[Id] = @__userId_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-12-08 23:49:51.670 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Role]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Id] = @__id_0
2025-12-08 23:49:51.676 +02:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Id] = @__id_0
2025-12-08 23:49:51.684 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@p8='?' (DbType = Int64), @p0='?' (DbType = DateTime2), @p1='?' (Size = 255), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 4000), @p7='?' (Size = 30)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CleanArium].[Users] SET [CreatedAt] = @p0, [Email] = @p1, [IsBlocked] = @p2, [LastLoginAt] = @p3, [PasswordHash] = @p4, [Role] = @p5, [Salt] = @p6, [UserName] = @p7
OUTPUT 1
WHERE [Id] = @p8;
2025-12-08 23:49:51.684 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.String'.
2025-12-08 23:49:51.684 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.RemoveModerator (CleanArium) in 37.9831ms
2025-12-08 23:49:51.684 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.RemoveModerator (CleanArium)'
2025-12-08 23:49:51.685 +02:00 [INF] Request finished HTTP/2 POST https://localhost:7085/api/Admin/3/remove-moderator - 200 null text/plain; charset=utf-8 49.8353ms
2025-12-08 23:49:54.625 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Admin/moderators - null null
2025-12-08 23:49:54.626 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.GetModerators (CleanArium)'
2025-12-08 23:49:54.626 +02:00 [INF] Route matched with {action = "GetModerators", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetModerators() on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 23:49:54.642 +02:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[CreatedAt], [u].[Email], [u].[IsBlocked], [u].[LastLoginAt], [u].[PasswordHash], [u].[Role], [u].[Salt], [u].[UserName]
FROM [CleanArium].[Users] AS [u]
WHERE [u].[Role] = 2
2025-12-08 23:49:54.642 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Application.DTOs.Users.ModeratorDto, Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-12-08 23:49:54.642 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.GetModerators (CleanArium) in 16.5102ms
2025-12-08 23:49:54.642 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.GetModerators (CleanArium)'
2025-12-08 23:49:54.643 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Admin/moderators - 200 null application/json; charset=utf-8 17.758ms
2025-12-08 23:50:03.270 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Admin/system-settings - null null
2025-12-08 23:50:03.271 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.Get (CleanArium)'
2025-12-08 23:50:03.275 +02:00 [INF] Route matched with {action = "Get", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get() on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 23:50:03.301 +02:00 [WRN] The query uses the 'First'/'FirstOrDefault' operator without 'OrderBy' and filter operators. This may lead to unpredictable results.
2025-12-08 23:50:03.317 +02:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[Id], [s].[MaxAlarmRulesPerDevice], [s].[MaxAquariumsPerUser], [s].[MaxDevicesPerAquarium], [s].[MaxScheduledCommandsPerDevice]
FROM [CleanArium].[SystemSettings] AS [s]
2025-12-08 23:50:03.358 +02:00 [ERR] Failed executing DbCommand (20ms) [Parameters=[@p0='?' (DbType = Int64), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CleanArium].[SystemSettings] ([Id], [MaxAlarmRulesPerDevice], [MaxAquariumsPerUser], [MaxDevicesPerAquarium], [MaxScheduledCommandsPerDevice])
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-12-08 23:50:03.506 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'Persistence.Application.CleanAriumDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'SystemSettings' when IDENTITY_INSERT is set to OFF.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:2338e5de-e1c4-438e-be86-65881aafee1b
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'SystemSettings' when IDENTITY_INSERT is set to OFF.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:2338e5de-e1c4-438e-be86-65881aafee1b
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-12-08 23:50:04.275 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.Get (CleanArium) in 1000.1519ms
2025-12-08 23:50:04.276 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.Get (CleanArium)'
2025-12-08 23:50:04.574 +02:00 [ERR] Unhandled exception
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'SystemSettings' when IDENTITY_INSERT is set to OFF.
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:2338e5de-e1c4-438e-be86-65881aafee1b
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Persistence.Repositories.SystemSettingsRepository.GetAsync() in C:\Users\User\source\repos\CleanArium\Persistence\Repositories\SystemSettingsRepository.cs:line 32
   at Application.SystemSettings.Queries.GetAll.GetSystemSettingsQueryHandler.Handle(GetSystemSettingsQuery request, CancellationToken ct) in C:\Users\User\source\repos\CleanArium\Application\SystemSettings\Queries\GetAll\GetSystemSettingsQueryHandler.cs:line 18
   at CleanArium.Extensions.ValidationBehavior`2.Handle(TRequest request, RequestHandlerDelegate`1 next, CancellationToken cancellationToken) in C:\Users\User\source\repos\CleanArium\CleanArium\Extensions\ValidationBehavior.cs:line 37
   at CleanArium.Controllers.AdminController.Get() in C:\Users\User\source\repos\CleanArium\CleanArium\Controllers\AdminController.cs:line 69
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at CleanArium.Middleware.ExceptionMiddleware.Invoke(HttpContext context) in C:\Users\User\source\repos\CleanArium\CleanArium\Middleware\ExceptionMiddleware.cs:line 18
2025-12-08 23:50:04.675 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Admin/system-settings - 500 null application/json; charset=utf-8 1406.0108ms
2025-12-08 23:51:00.055 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/AlarmRule/get-all-by-device/1 - null null
2025-12-08 23:51:00.065 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-12-08 23:51:00.068 +02:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-12-08 23:51:00.068 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/AlarmRule/get-all-by-device/1 - 403 0 null 13.8564ms
2025-12-08 23:51:20.377 +02:00 [INF] Request starting HTTP/2 GET https://localhost:7085/api/Admin/logs - null null
2025-12-08 23:51:20.378 +02:00 [INF] Executing endpoint 'CleanArium.Controllers.AdminController.GetLogs (CleanArium)'
2025-12-08 23:51:20.420 +02:00 [INF] Route matched with {action = "GetLogs", controller = "Admin"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetLogs() on controller CleanArium.Controllers.AdminController (CleanArium).
2025-12-08 23:51:20.447 +02:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.String'.
2025-12-08 23:51:20.447 +02:00 [INF] Executed action CleanArium.Controllers.AdminController.GetLogs (CleanArium) in 26.9623ms
2025-12-08 23:51:20.447 +02:00 [INF] Executed endpoint 'CleanArium.Controllers.AdminController.GetLogs (CleanArium)'
2025-12-08 23:51:20.448 +02:00 [INF] Request finished HTTP/2 GET https://localhost:7085/api/Admin/logs - 404 null text/plain; charset=utf-8 71.2185ms
